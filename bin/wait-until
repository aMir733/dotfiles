#!/bin/bash
# Wait for a program to finish and then return 0 when it does

i=0
if [[ "a$2" == "a" ]] ; then timeout=-1 ; else timeout="$2" ; fi
while true ; do
    if ! pgrep "$1" &>/dev/null ; then
        exit 0
    elif [[ $i == $timeout ]] ; then 
        exit 1
    fi
    ((i++))
    sleep 1
done
